# Preflight Selenium autoheal plugin 
- Allows running tests generated by the Preflight recorder
- With this plugin you can use advanced Preflight features in your Selenium test
### Main supported features
- **Selectors autoheal**. If your UI changes and element cannot be found by specified selector, Preflight can find the right element and use it
- **Email testing**. Test receiving of you emails e.g. from your Sigh Up form
- **Autogenerated values**. You can generate values like email, name, address etc. and then use them in your tests including page element values checks
- File upload to forms
- 

## Create an account on [Preflight.com](https://app.preflight.com/get-started?afmc=seleniumPlugin)
- The API key will be generated for you automatically after creating account.
- Alternatively you can go to [Account Settings / API](https://app.preflight.com/account/api) to generate a new one.

![API key screenshot](https://user-images.githubusercontent.com/17752807/173562411-cbadcf91-068e-45f1-a7ef-0415e55c69eb.png)

## Add JAR file to your project dependencies
- You can download [JAR file here](https://github.com/Preflight-HQ/PreflightSeleniumJavaPlugin/raw/main/build/libs/PreflightSeleniumJavaAutohealPlugin.jar)
- Or add it from Maven central repository https://search.maven.org/artifact/com.preflight/preflight-selenium-plugin
- Please note that the package has dependency on `selenium-java` package 

## Set API key in your test environment
- Use following code to set API key for the plugin   
```
public static void main(String[] args) throws Exception {
    PreflightDriver.PreflightApiKey = [YOUR_API_KEY];
}
```

## Creating test
- Once you have the plugin installed and set up with the API key you can create your first test.
- Download Chrome extension [Selenium Java Recorder from Preflight](https://chrome.google.com/webstore/detail/selenium-java-recorder-fr/jdlnooljpbijcnlgocdegmibdlnkljde?hl=en-US)
- Log in and follow instructions on the video to create your first test. ([Full quality video](https://www.loom.com/share/6cb9f1566a7e41ac9bf1744a5d6b569a))

<img src="https://preflightuploads.blob.core.windows.net/uploads/PreflightSeleniumCodeGenerator.gif" alt="Create test">

## Creating POM
- To create POM open the Chrome extension and click on button `Generate POM` 
- On the next screen you can interactively add/remove page elements from the POM
- Once you are done click on `Create POM` button and your code will be generated

<img src="https://preflightuploads.blob.core.windows.net/uploads/JavaSeleniumPOM.gif" alt="Create POM">

### Generated code
- Generated code can be added to any project including the Preflight Selenium plugin
- Advanced features like selectors autoheal or email testing will be possible only with valid API key
- Please note that in the current version **you need to disable web security ("--disable-web-security")** in the driver for all functionality to work.
- Below is an example code of log in test
```
    public static void signUpTest() throws Exception {
        ChromeOptions options = new ChromeOptions();
        options.addArguments("--disable-web-security");
        PreflightDriver driver = new PreflightDriver(new ChromeDriver(options));
        
        driver.initializeAutohealTest("dUzJ8QDi7tvs");
        driver.get("https://yourweb.app/#/signup");
        driver.findElement(By.cssSelector("#pf-lesson-signup-0"), "2").sendKeys("{{name.firstName}}");
        driver.findElement(By.cssSelector("#pf-lesson-signup-1"), "3").sendKeys("{{name.lastName}}");
        driver.findElement(By.cssSelector("#pf-lesson-signup-2"), "4").sendKeys("{{generate.email}}");
        driver.findElement(By.cssSelector("#pf-lesson-signup-3"), "5").sendKeys("123456");
        driver.findElement(By.cssSelector(".text-white"), "6").click();
        driver.openEmail("Verify your email");
        driver.findElement(By.cssSelector("a"), "8", By.cssSelector("iframe#pf-email-iframe")).click();
        driver.closeEmail();
        driver.findElement(By.cssSelector(".leading-tight"), "10").checkValue("Email verified successfully!");

    }
```
